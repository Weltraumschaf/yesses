data:
  Origins:
    - url: http://apache2.dev.intranet/
      ip: 172.16.0.3
      domain: apache2.dev.intranet
  Expected-Paths:
    - url: http://apache2.dev.intranet:80/
    - url: http://apache2.dev.intranet:80/index.html
    - url: http://apache2.dev.intranet:80/download.php
    - url: http://apache2.dev.intranet:80/site.html
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/file.js
  Expected-Hidden-Paths:
    - url: http://apache2.dev.intranet:80/status/server-info
    - url: http://apache2.dev.intranet:80/status/
    - url: http://apache2.dev.intranet:80/manual/
    - url: http://apache2.dev.intranet:80/manual/logs/
    - url: http://apache2.dev.intranet:80/manual/logs/httpd/
    - url: http://apache2.dev.intranet:80/manual/logs/robots.txt
    - url: http://apache2.dev.intranet:80/manual/logs/httpd/status/
    - url: http://apache2.dev.intranet:80/hdir/
    - url: http://apache2.dev.intranet:80/hdir/hdir/
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/error
  Expected-Directories:
    - url: http://apache2.dev.intranet:80/
    - url: http://apache2.dev.intranet:80/status/
    - url: http://apache2.dev.intranet:80/manual/
    - url: http://apache2.dev.intranet:80/manual/logs/
    - url: http://apache2.dev.intranet:80/manual/logs/httpd/
    - url: http://apache2.dev.intranet:80/manual/logs/httpd/status/
    - url: http://apache2.dev.intranet:80/hdir/
    - url: http://apache2.dev.intranet:80/hdir/hdir/
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/
  Expected-Leakages:
    - url: http://apache2.dev.intranet:80/manual/logs/
      type: path
      found: visible_text
      finding: /manual/logs
    - url: http://apache2.dev.intranet:80/manual/logs/
      type: file
      found: visible_text
      finding: robots.txt
    - url: http://apache2.dev.intranet:80/manual/logs/httpd/
      type: path
      found: visible_text
      finding: /manual/logs/httpd
    - url: http://apache2.dev.intranet:80/manual/logs/httpd/status/
      type: path
      found: visible_text
      finding: /manual/logs/httpd/status
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/
      type: path
      found: visible_text
      finding: /hdir/hdir/hdir/hdir
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/
      type: file
      found: visible_text
      finding: file.js
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/file.js
      type: ip
      found: css_js_comment
      finding: 192.168.1.123
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/file.js
      type: path
      found: css_js_comment
      finding: /var/www/html/secret.txt
    - url: http://apache2.dev.intranet:80/hdir/hdir/hdir/hdir/file.js
      type: email
      found: css_js_comment
      finding: webmaster@example.com

run:
  - discover Linked Paths:
      origins: use Origins
    find:
      - Linked-Paths
      - Linked-Pages
    expect:
      - all Expected-Paths in Linked-Paths, otherwise alert high
      - all Linked-Paths in Expected-Paths, otherwise alert high
  - discover Hidden Paths:
      origins: use Origins
      linked_paths: use Linked-Paths
      recursion_depth: 3
    find:
      - Hidden-Paths
      - Hidden-Pages
      - Directories
    expect:
      - all Expected-Directories in Directories, otherwise alert high
      - all Directories in Expected-Directories, otherwise alert high
      - all Expected-Hidden-Paths in Hidden-Paths, otherwise alert high
      - all Hidden-Paths in Expected-Hidden-Paths, otherwise alert high
  - discover Error Paths:
      origins: use Origins
    find:
      - Error-Pages
  - scan Information Leakage:
      pages: use Linked-Pages and Hidden-Pages and Error-Pages
    find:
      - Leakages
    expect:
      - all Expected-Leakages in Leakages, otherwise alert high
      - all Leakages in Expected-Leakages, otherwise alert high